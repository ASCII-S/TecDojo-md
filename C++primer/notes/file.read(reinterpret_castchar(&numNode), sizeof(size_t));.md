---
jupyter:
  jupytext:
    text_representation:
      extension: .md
      format_name: markdown
      format_version: '1.3'
      jupytext_version: 1.14.4
  kernelspec:
    display_name: C++
    language: c++
    name: xcpp11
---

---
Created time: 2025-03-26T14:48
åŠ å…¥å¸¦èƒŒ: true
jupyter:
  jupytext:
    cell_metadata_filter: language,-all
    formats: md,ipynb
    main_language: c++
    text_representation:
      extension: .md
      format_name: markdown
      format_version: '1.3'
      jupytext_version: 1.14.7
---
å¥½ï¼è¿™å¥ä»£ç æ˜¯æ–‡ä»¶è¯»å–æ“ä½œä¸­çš„ç»å…¸å†™æ³•ï¼Œå’±ä»¬æ¥é€ä¸ªæ‹†è§£åˆ†æä¸€ä¸‹å®ƒçš„è¯­æ³•å’Œå«ä¹‰ï¼š


```
file.read(reinterpret_cast<char*>(&numNode), sizeof(size_t));
```

---
## ğŸ“Œ ä¸€å¥è¯è§£é‡Šï¼š

> ä»æ–‡ä»¶æµ file ä¸­è¯»å– sizeof(size_t) å­—èŠ‚çš„æ•°æ®ï¼Œå¡«å……åˆ°å˜é‡ numNode æ‰€åœ¨çš„å†…å­˜ä½ç½®ã€‚
---
## ğŸ§± æ‹†è§£è®²è§£
### 1. `file.read(...)`
è¿™æ˜¯ `std::ifstream`ï¼ˆæˆ– `std::istream`ï¼‰çš„æˆå‘˜å‡½æ•°ï¼Œç”¨äº**è¯»å–åŸå§‹äºŒè¿›åˆ¶æ•°æ®**ã€‚


```
istream& read(char* buffer, std::streamsize count);
```

- `buffer`: è¯»å–çš„ç›®æ ‡å†…å­˜åœ°å€ï¼Œå¿…é¡»æ˜¯ `char*` ç±»å‹
- `count`: è¦è¯»å–çš„å­—èŠ‚æ•°
---
### 2. `reinterpret_cast<char*>(&numNode)`
è¿™ä¸€éƒ¨åˆ†ç¨å¾®å¤æ‚ï¼Œæ˜¯ç±»å‹è½¬æ¢ï¼š
### ğŸ‘‡ æ‹†åˆ†ç†è§£ï¼š
- `&numNode`ï¼šå–å˜é‡çš„åœ°å€ï¼Œç±»å‹ä¸º `size_t*`
- `reinterpret_cast<char*>...`ï¼šå¼ºåˆ¶ç±»å‹è½¬æ¢ä¸º `char*`
âš ï¸ ä¸ºä»€ä¹ˆè¦è½¬æˆ `char*`ï¼Ÿ
- å› ä¸º `read()` åªèƒ½æ¥å— `char*` ç±»å‹ç¼“å†²åŒº
- å†…éƒ¨æ˜¯æŒ‰å­—èŠ‚è¯»çš„ï¼Œ`char*` æ˜¯å­—èŠ‚æŒ‡é’ˆ
---
### 3. `sizeof(size_t)`
- è¡¨ç¤ºè¯»å– `size_t` ç±»å‹çš„å¤§å°ï¼Œé€šå¸¸æ˜¯ 4 æˆ– 8 ä¸ªå­—èŠ‚
- ä¿è¯æˆ‘ä»¬è¯»å…¥çš„æ•°æ®**å®Œå…¨è¦†ç›– numNode çš„å†…å­˜ç©ºé—´**
---
## ğŸ§  æ€»ç»“è¿™å¥ä»£ç åœ¨åšä»€ä¹ˆï¼Ÿ


```
file.read(reinterpret_cast<char*>(&numNode), sizeof(size_t));
```

å«ä¹‰æ˜¯ï¼š

> æŠŠæ–‡ä»¶ä¸­å½“å‰æŒ‡é’ˆæ‰€æŒ‡å‘çš„ sizeof(size_t) å­—èŠ‚æ•°æ® è¯»åˆ°å˜é‡ numNode ä¸­ï¼ŒæŒ‰å†…å­˜åŸæ ·æ‹·è´ã€‚
---
## âš ï¸ æ³¨æ„äº‹é¡¹
|   |   |
|---|---|
|é—®é¢˜|è¯´æ˜|
|è¯»å–å‰å¿…é¡»æ‰“å¼€æ–‡ä»¶ä¸”å®šä½åˆ°æ­£ç¡®ä½ç½®ï¼ˆ`seekg`ï¼‰||
|`read()` ä¸è¿›è¡Œä»»ä½•æ ¼å¼è§£æï¼Œ**åªæ˜¯å­—èŠ‚å¤åˆ¶**||
|å¦‚æœå¹³å°å­—èŠ‚åºä¸åŒï¼ˆå¤§å°ç«¯å·®å¼‚ï¼‰ï¼Œä¼šå¯¼è‡´è¯»å–é”™è¯¯||
|å¤šç”¨äºè¯»å–äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¾‹å¦‚ `.bin`ã€è‡ªå®šä¹‰ç»“æ„åºåˆ—åŒ–æ–‡ä»¶ç­‰||
---
## ğŸ“ å­¦ä¹ ç¬”è®°æ¨¡æ¿
```Plain
# file.read + reinterpret_cast ç¬”è®°
ğŸ“Œ å…¸å‹å†™æ³•ï¼š
file.read(reinterpret_cast<char*>(&obj), sizeof(obj));
âœ… ç”¨äºï¼š
- è¯»å–åŸå§‹äºŒè¿›åˆ¶æ•°æ®åˆ°å†…å­˜å˜é‡
- ç»“æ„ä½“ã€æ•´æ•°ã€æ•°ç»„ç­‰
ğŸ“¦ æ ¸å¿ƒè¯­æ³•ç‚¹ï¼š
- read(char*, size)
- reinterpret_cast<char*>(...)
âš ï¸ æ³¨æ„ï¼š
- åªé€‚ç”¨äº PODï¼ˆPlain Old Dataï¼‰ç±»å‹
- ä¸èƒ½ç›´æ¥ç”¨äºå¤æ‚ C++ ç±»å¯¹è±¡
- è¦æ³¨æ„è·¨å¹³å°å­—èŠ‚åºé—®é¢˜ï¼ˆå¯ç”¨ ntohl/htonlï¼‰
```
---
å¦‚æœä½ è¿˜æƒ³çœ‹åå‘æ“ä½œï¼ˆ`write()`ï¼‰æˆ–æ˜¯ç»“æ„ä½“çš„ä¸€æ¬¡æ€§è¯»å–ç¤ºä¾‹ï¼Œæˆ‘ä¹Ÿå¯ä»¥å¸®ä½ å†™ä¸€ä¸ªå°ä¾‹å­ï¼è¦ä¸è¦ï¼Ÿ
