---
jupyter:
  jupytext:
    text_representation:
      extension: .md
      format_name: markdown
      format_version: '1.3'
      jupytext_version: 1.14.4
  kernelspec:
    display_name: C++
    language: c++
    name: xcpp11
---

---
Created time: 2025-04-10T15:01
åŠ å…¥å¸¦èƒŒ: true
jupyter:
  jupytext:
    cell_metadata_filter: language,-all
    formats: md,ipynb
    main_language: c++
    text_representation:
      extension: .md
      format_name: markdown
      format_version: '1.3'
      jupytext_version: 1.14.7
---
å¥½é—®é¢˜ï¼ä½ é—®çš„ **ç§»åŠ¨æ„é€ å‡½æ•°** æ˜¯ C++11 å¼•å…¥çš„ä¸€é¡¹é‡è¦ç‰¹æ€§ï¼Œå®ƒæ˜¯ç°ä»£ C++æ€§èƒ½ä¼˜åŒ–çš„â€œç¥å™¨â€ä¹‹ä¸€ï¼Œå°¤å…¶é€‚åˆç®¡ç† **èµ„æº**ï¼ˆå¦‚åŠ¨æ€å†…å­˜ã€æ–‡ä»¶å¥æŸ„ç­‰ï¼‰çš„ç±»ã€‚
---
## ğŸ¯ ä»€ä¹ˆæ˜¯ç§»åŠ¨æ„é€ å‡½æ•°ï¼Ÿ

> ç§»åŠ¨æ„é€ å‡½æ•° æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ„é€ å‡½æ•°ï¼Œç”¨äº â€œæŠ¢å â€å¦ä¸€ä¸ªå¯¹è±¡çš„èµ„æºï¼Œè€Œä¸æ˜¯å¤åˆ¶å®ƒä»¬ï¼Œå®ç°â€œå¿«é€Ÿæ„é€ â€ã€‚
å®ƒçš„ç›®çš„å°±æ˜¯ï¼š
âœ… **é¿å…æ·±æ‹·è´**
âœ… **æå‡æ€§èƒ½**
âœ… **è½¬ç§»æ‰€æœ‰æƒ**
---
## ğŸ“Œ è¯­æ³•æ ¼å¼


```
ClassName(ClassName&& other) noexcept;
```

- å‚æ•°æ˜¯ **å³å€¼å¼•ç”¨ï¼ˆT&&ï¼‰**
- `noexcept` è¡¨ç¤ºå‡½æ•°ä¸ä¼šæŠ›å¼‚å¸¸ï¼Œæ¨èåŠ ä¸Š
---
## ğŸ§  ä»€ä¹ˆæ—¶å€™ä¼šè¢«è°ƒç”¨ï¼Ÿ
- å½“ä½ ç”¨ä¸€ä¸ª **ä¸´æ—¶å¯¹è±¡** æˆ– `std::move()` æ ‡è®°çš„å¯¹è±¡æ¥ **åˆå§‹åŒ–å¦ä¸€ä¸ªå¯¹è±¡**ï¼š


```
MyClass a = std::move(b);  // âœ… ç§»åŠ¨æ„é€ å‡½æ•°è¢«è°ƒç”¨
MyClass a = MyClass();     // âœ… ä¸´æ—¶å¯¹è±¡ => å³å€¼
```

---
## ğŸ“¦ ç¤ºä¾‹ï¼šç§»åŠ¨æ„é€  vs æ‹·è´æ„é€ 


```
class MyArray {
    int* data;
    size_t size;
public:
    MyArray(size_t s) : size(s), data(new int[s]) {}
    ~MyArray() { delete[] data; }
    // âœ… ç§»åŠ¨æ„é€ å‡½æ•°
    MyArray(MyArray&& other) noexcept {
        std::cout << "ç§»åŠ¨æ„é€ è¢«è°ƒç”¨\n";
        data = other.data;
        size = other.size;
        other.data = nullptr;
        other.size = 0;
    }
    // âœ… æ‹·è´æ„é€ å‡½æ•°ï¼ˆå¯¹æ¯”ç”¨ï¼‰
    MyArray(const MyArray& other) {
        std::cout << "æ‹·è´æ„é€ è¢«è°ƒç”¨\n";
        data = new int[other.size];
        size = other.size;
        std::copy(other.data, other.data + size, data);
    }
};
```

---
## ğŸ¯ ä½¿ç”¨åœºæ™¯ä¸¾ä¾‹


```
MyArray a(10000);
MyArray b = std::move(a);  // âœ… è§¦å‘ç§»åŠ¨æ„é€ ï¼Œè€Œä¸æ˜¯æ‹·è´æ„é€ 
```

æ‰§è¡Œå®Œï¼š
- `b` æ¥ç®¡äº† `a` çš„èµ„æº
- `a.data == nullptr`ï¼Œä¸ä¼šé‡Šæ”¾åŸèµ„æº
---
## ğŸš¨ ä¸ºä»€ä¹ˆåŠ  `noexcept`ï¼Ÿ

> STL å®¹å™¨ï¼ˆå¦‚ std::vectorï¼‰åœ¨å†…éƒ¨æ‰©å®¹æ—¶ï¼Œä¼šä¼˜å…ˆç”¨ noexcept çš„ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œå¦åˆ™é€€åŒ–æˆæ‹·è´æ„é€ ï¼
---
## ğŸ“ å¿«é€Ÿç¬”è®°æ¨¡æ¿
```Plain
# ç§»åŠ¨æ„é€ å‡½æ•°ï¼ˆC++11ï¼‰
âœ… å®šä¹‰ï¼š
T(T&& other) noexcept;
ğŸ¯ ç”¨é€”ï¼š
- è½¬ç§»èµ„æºæ‰€æœ‰æƒï¼Œé¿å…æ·±æ‹·è´
ğŸ“Œ å…¸å‹è¯­æ³•ï¼š
MyClass(MyClass&& other) noexcept {
    this->data = other.data;
    other.data = nullptr;
}
âš ï¸ æ³¨æ„ï¼š
- å‚æ•°æ˜¯å³å€¼å¼•ç”¨ (T&&)
- ä¸è¦å¿˜è®°æ¸…ç©ºåŸå¯¹è±¡èµ„æº
- æ¨èåŠ  noexcept
- ä¸èƒ½ç»‘å®š const å¯¹è±¡
```
---
å¦‚æœä½ æƒ³ï¼Œæˆ‘å¯ä»¥ç»™ä½ å†™ä¸ª `æ‹·è´æ„é€  vs ç§»åŠ¨æ„é€ ` çš„**å®Œæ•´å¯è¿è¡Œç¤ºä¾‹ + è¾“å‡ºå¯¹æ¯”**ï¼Œä½ è‡ªå·±è·‘ä¸€éå°±å½»åº•æ˜ç™½äº†ã€‚è¦ä¸è¦ï¼Ÿ
