---
jupyter:
  jupytext:
    text_representation:
      extension: .md
      format_name: markdown
      format_version: '1.3'
      jupytext_version: 1.14.4
  kernelspec:
    display_name: C++
    language: c++
    name: xcpp11
---

---
jupyter:
  jupytext:
    cell_metadata_filter: -all
    formats: md,ipynb
    main_language: python
    text_representation:
      extension: .md
      format_name: markdown
      format_version: '1.3'
      jupytext_version: 1.14.7
---

# **C++ `explicit` å…³é”®å­—å­¦ä¹ ç¬”è®°**  

## **1. `explicit` çš„ä½œç”¨**  
`explicit` ç”¨äºä¿®é¥° **æ„é€ å‡½æ•°** æˆ– **ç±»å‹è½¬æ¢è¿ç®—ç¬¦**ï¼Œé˜²æ­¢ç¼–è¯‘å™¨è¿›è¡Œ **éšå¼è½¬æ¢**ï¼Œè¦æ±‚å¿…é¡» **æ˜¾å¼è°ƒç”¨**ã€‚  

### **æ ¸å¿ƒä½œç”¨**  
âœ… **ç¦æ­¢éšå¼è½¬æ¢**ï¼Œé¿å…æ„å¤–çš„ç±»å‹è½¬æ¢å¯¼è‡´é€»è¾‘é”™è¯¯ã€‚  
âœ… **æé«˜ä»£ç å¯è¯»æ€§**ï¼Œæ˜ç¡®è¡¨è¾¾æ„é€ æˆ–è½¬æ¢çš„æ„å›¾ã€‚  

---

## **2. `explicit` ä¿®é¥°æ„é€ å‡½æ•°**  
### **ï¼ˆ1ï¼‰æœªä½¿ç”¨ `explicit`ï¼ˆå…è®¸éšå¼è½¬æ¢ï¼‰**  
```cpp
class MyClass {
public:
    MyClass(int x) : value(x) {} // å…è®¸éšå¼è½¬æ¢
private:
    int value;
};

void foo(MyClass obj) {}

int main() {
    foo(42); // éšå¼è°ƒç”¨ MyClass(42)
    MyClass obj = 10; // éšå¼æ„é€ 
    return 0;
}
```
ğŸ”¹ **é—®é¢˜**ï¼š`42` è¢«éšå¼è½¬æ¢ä¸º `MyClass`ï¼Œå¯èƒ½å¯¼è‡´éš¾ä»¥å¯Ÿè§‰çš„é”™è¯¯ã€‚  

### **ï¼ˆ2ï¼‰ä½¿ç”¨ `explicit`ï¼ˆç¦æ­¢éšå¼è½¬æ¢ï¼‰**  
```cpp
class MyClass {
public:
    explicit MyClass(int x) : value(x) {} // ç¦æ­¢éšå¼è½¬æ¢
private:
    int value;
};

void foo(MyClass obj) {}

int main() {
    // foo(42); // âŒ é”™è¯¯ï¼šä¸èƒ½éšå¼è½¬æ¢
    foo(MyClass(42)); // âœ… å¿…é¡»æ˜¾å¼æ„é€ 
    MyClass obj(10); // âœ… æ˜¾å¼æ„é€ 
    // MyClass obj = 10; // âŒ é”™è¯¯ï¼šä¸èƒ½éšå¼è½¬æ¢
    return 0;
}
```
ğŸ”¹ **ä¼˜ç‚¹**ï¼šé¿å…æ„å¤–è½¬æ¢ï¼Œä»£ç æ›´å®‰å…¨ã€‚  

---

## **3. `explicit` ä¿®é¥°ç±»å‹è½¬æ¢è¿ç®—ç¬¦ï¼ˆC++11 èµ·ï¼‰**  
`explicit` ä¹Ÿå¯ä»¥ç”¨äº **ç±»å‹è½¬æ¢è¿ç®—ç¬¦**ï¼Œé˜²æ­¢éšå¼è½¬æ¢ã€‚  

### **ï¼ˆ1ï¼‰æœªä½¿ç”¨ `explicit`ï¼ˆå…è®¸éšå¼è½¬æ¢ï¼‰**  
```cpp
class MyClass {
public:
    operator bool() const { return value != 0; } // å…è®¸éšå¼è½¬æ¢
private:
    int value;
};

int main() {
    MyClass obj;
    if (obj) { // éšå¼è½¬æ¢ä¸º bool
        // ...
    }
    return 0;
}
```
ğŸ”¹ **é—®é¢˜**ï¼š`obj` å¯èƒ½è¢«æ„å¤–ç”¨äº `if`ã€`while` ç­‰æ¡ä»¶åˆ¤æ–­ï¼Œå¯¼è‡´é€»è¾‘ä¸æ¸…æ™°ã€‚  

### **ï¼ˆ2ï¼‰ä½¿ç”¨ `explicit`ï¼ˆç¦æ­¢éšå¼è½¬æ¢ï¼‰**  
```cpp
class MyClass {
public:
    explicit operator bool() const { return value != 0; } // ç¦æ­¢éšå¼è½¬æ¢
private:
    int value;
};

int main() {
    MyClass obj;
    // if (obj) { // âŒ é”™è¯¯ï¼šä¸èƒ½éšå¼è½¬æ¢
    if (static_cast<bool>(obj)) { // âœ… å¿…é¡»æ˜¾å¼è½¬æ¢
        // ...
    }
    return 0;
}
```
ğŸ”¹ **ä¼˜ç‚¹**ï¼šé¿å…æ„å¤–çš„ `bool` è½¬æ¢ï¼Œæé«˜ä»£ç å®‰å…¨æ€§ã€‚  

---

## **4. é€‚ç”¨åœºæ™¯**  
âœ… **æ¨èä½¿ç”¨ `explicit` çš„æƒ…å†µ**ï¼š  
- **å•å‚æ•°æ„é€ å‡½æ•°**ï¼ˆå¦‚ `MyClass(int)`ï¼‰ï¼Œé¿å…éšå¼æ„é€ ã€‚  
- **ç±»å‹è½¬æ¢è¿ç®—ç¬¦**ï¼ˆå¦‚ `operator bool()`ï¼‰ï¼Œé¿å…æ„å¤–è½¬æ¢ã€‚  

âŒ **ä¸éœ€è¦ `explicit` çš„æƒ…å†µ**ï¼š  
- **å¤šå‚æ•°æ„é€ å‡½æ•°**ï¼ˆå¦‚ `MyClass(int, int)`ï¼‰ï¼Œå› ä¸º C++11 å‰æ— æ³•éšå¼è½¬æ¢ã€‚  
- **é»˜è®¤æ„é€ å‡½æ•°**ï¼ˆæ— å‚æ•°ï¼‰ï¼Œå› ä¸ºæ— æ³•éšå¼è°ƒç”¨ã€‚  

---

## **5. æ€»ç»“**  
| **æƒ…å†µ** | **æœªä½¿ç”¨ `explicit`** | **ä½¿ç”¨ `explicit`** |
|----------|----------------------|---------------------|
| **æ„é€ å‡½æ•°** | å…è®¸éšå¼æ„é€  `MyClass obj = 42;` | å¿…é¡»æ˜¾å¼æ„é€  `MyClass obj(42);` |
| **ç±»å‹è½¬æ¢** | å…è®¸éšå¼è½¬æ¢ `if (obj)` | å¿…é¡»æ˜¾å¼è½¬æ¢ `if (static_cast<bool>(obj))` |
| **ä¼˜ç‚¹** | ä»£ç æ›´ç®€æ´ | é¿å…æ„å¤–è½¬æ¢ï¼Œæ›´å®‰å…¨ |
| **ç¼ºç‚¹** | å¯èƒ½å¯¼è‡´é€»è¾‘é”™è¯¯ | éœ€è¦æ˜¾å¼è°ƒç”¨ï¼Œä»£ç ç¨é•¿ |

ğŸ”¹ **æœ€ä½³å®è·µ**ï¼š  
- **é»˜è®¤ç»™å•å‚æ•°æ„é€ å‡½æ•°åŠ  `explicit`**ï¼Œé™¤éæ˜ç¡®éœ€è¦éšå¼è½¬æ¢ã€‚  
- **è°¨æ…ä½¿ç”¨ç±»å‹è½¬æ¢è¿ç®—ç¬¦**ï¼Œå°½é‡ç”¨ `explicit` ä¿®é¥°ã€‚  

---

## **6. ç»ƒä¹ **  
1. å®šä¹‰ä¸€ä¸ª `StringWrapper` ç±»ï¼Œæ¥å— `const char*` æ„é€ ï¼Œå¹¶ç¦æ­¢éšå¼è½¬æ¢ã€‚  
2. å®šä¹‰ä¸€ä¸ª `SafeBool` ç±»ï¼Œæä¾› `explicit operator bool()`ï¼Œå¹¶æµ‹è¯•å…¶ä½¿ç”¨ã€‚  

---

ğŸ“Œ **å…³é”®ç‚¹**ï¼š`explicit` æ˜¯ C++ é˜²æ­¢éšå¼è½¬æ¢çš„é‡è¦æœºåˆ¶ï¼Œåˆç†ä½¿ç”¨èƒ½æé«˜ä»£ç çš„å¥å£®æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚
